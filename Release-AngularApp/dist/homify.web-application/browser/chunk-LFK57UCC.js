import{a as O}from"./chunk-FBMKTQUY.js";import"./chunk-QYMZVT5J.js";import{a as x,b as P,c as U,d as j}from"./chunk-SYY7HDF4.js";import{c as F,m as L}from"./chunk-G254O7HO.js";import{$ as M,Ac as w,D as b,Jb as o,Lb as f,Rb as C,Sa as c,Ta as _,_ as g,da as v,hb as S,ja as d,jb as T,ka as R,mb as E,nb as D,ob as B,pb as k,qb as r,rb as n,sb as p,yb as m,zb as I}from"./chunk-NEYM5HGW.js";var $=(()=>{class e extends U{constructor(t){super(j.homifyApi,"notifications",t)}getUserNotifications(t){return this.get("",t).pipe(b(this.handleError))}readNotification(t){return this.putById(t).pipe(b(this.handleError))}static{this.\u0275fac=function(i){return new(i||e)(v(F))}}static{this.\u0275prov=g({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var y=(()=>{class e{constructor(t){this._repository=t}getUserNotifications(t,i,a){let s=[];t&&s.push(`deviceType=${encodeURIComponent(t)}`),i&&s.push(`date=${encodeURIComponent(i)}`),a&&s.push(`read=${encodeURIComponent(a)}`);let l=s.join("&");return this._repository.getUserNotifications(l)}readNotification(t){return this._repository.readNotification(t)}static{this.\u0275fac=function(i){return new(i||e)(v($))}}static{this.\u0275prov=g({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var q=(()=>{class e{constructor(t){this.NotificationService=t,this.notiId="",this.successMessage="",this.errorMessage=""}handleClick(){this.NotificationService.readNotification(this.notiId).subscribe(t=>this.successMessage="Notification read successfully",t=>this.errorMessage=t.error.message)}static{this.\u0275fac=function(i){return new(i||e)(_(y))}}static{this.\u0275cmp=d({type:e,selectors:[["app-read-notification-button"]],inputs:{notiId:"notiId"},standalone:!0,features:[C],decls:2,vars:0,consts:[[3,"click"]],template:function(i,a){i&1&&(r(0,"app-button",0),m("click",function(){return a.handleClick()}),o(1,` Read
`),n())},dependencies:[x]})}}return e})();function G(e,h){if(e&1&&(r(0,"app-read-notification-button",9),o(1,"Mark as Read"),n()),e&2){let t=I().$implicit;T("notiId",t.id)}}function V(e,h){if(e&1&&(r(0,"li")(1,"strong"),o(2,"Event:"),n(),o(3),p(4,"br"),r(5,"strong"),o(6,"Device ID:"),n(),o(7),p(8,"br"),r(9,"strong"),o(10,"Detail:"),n(),o(11),p(12,"br"),r(13,"strong"),o(14,"Device Type:"),n(),o(15),p(16,"br"),r(17,"strong"),o(18,"Date:"),n(),o(19),p(20,"br"),r(21,"div")(22,"strong"),o(23,"is Read:"),n(),o(24),p(25,"br"),S(26,G,2,1,"app-read-notification-button",9),n()()),e&2){let t=h.$implicit;c(3),f(" ",t.event," "),c(4),f(" ",t.deviceId," "),c(4),f(" ",t.detail," "),c(4),f(" ",t.deviceType," "),c(4),f(" ",t.date," "),c(5),f(" ",t.isRead," "),c(2),E(26,t.isRead?-1:26)}}function z(e,h){if(e&1&&(r(0,"ul"),B(1,V,27,7,"li",null,D),n()),e&2){let t=I();c(),k(t.notifications)}}function J(e,h){e&1&&(r(0,"p"),o(1,"No notifications available to show."),n())}var N=(()=>{class e{constructor(t){this.NotificationService=t,this.notifications=[],this.filterByEvent="",this.filterByDate="",this.filterByRead=""}ngOnInit(){this.NotificationService.getUserNotifications(this.filterByEvent,this.filterByDate,this.filterByRead).subscribe(t=>{this.notifications=t},t=>{console.error("Error getting notifications",t)})}handleRefresh(){this.NotificationService.getUserNotifications(this.filterByEvent,this.filterByDate,this.filterByRead).subscribe(t=>{this.notifications=t},t=>{console.error("Error getting notifications",t)})}handleSearchWithoutFilters(){this.NotificationService.getUserNotifications().subscribe(t=>{this.notifications=t},t=>{console.error("Error fetching notifications",t)})}onEventTriggeredChange(t){let i=t.target;this.filterByEvent=i.value}onDateChange(t){let i=t.target.value;if(!i){this.filterByDate="";return}let a=new Date(i+"T00:00:00"),s=a.getUTCDate().toString().padStart(2,"0"),l=(a.getUTCMonth()+1).toString().padStart(2,"0"),W=a.getUTCFullYear();this.filterByDate=`${s}/${l}/${W}`}onReadChange(t){this.filterByRead=t.target.checked.toString()}static{this.\u0275fac=function(i){return new(i||e)(_(y))}}static{this.\u0275cmp=d({type:e,selectors:[["app-notification-list"]],standalone:!0,features:[C],decls:21,vars:1,consts:[[1,"filters"],[2,"margin","5px 0","display","flex","align-items","center"],["for","eventTriggered"],["id","eventTriggered","type","text",3,"change"],["for","event_date"],["id","event_date","type","date",3,"change"],["id","eventTriggered","type","checkbox",3,"change"],[2,"display","flex","gap","10px","margin","10px 0"],[3,"click"],[3,"notiId"]],template:function(i,a){i&1&&(r(0,"article")(1,"div",0)(2,"div",1)(3,"label",2),o(4,"Device Type"),n(),r(5,"app-input",3),m("change",function(l){return a.onEventTriggeredChange(l)}),n()(),r(6,"div",1)(7,"label",4),o(8,"Date"),n(),r(9,"input",5),m("change",function(l){return a.onDateChange(l)}),n()(),r(10,"div",1)(11,"label",2),o(12,"Read"),n(),r(13,"input",6),m("change",function(l){return a.onReadChange(l)}),n()()(),r(14,"div",7)(15,"app-button",8),m("click",function(){return a.handleRefresh()}),o(16,"Refresh"),n(),r(17,"app-button",8),m("click",function(){return a.handleSearchWithoutFilters()}),o(18," Refresh with no filters "),n()(),S(19,z,3,0,"ul")(20,J,2,0),n()),i&2&&(c(19),E(19,a.notifications.length>0?19:20))},dependencies:[q,P,x],styles:["ul[_ngcontent-%COMP%]{list-style-type:none;padding:0;margin:0;font-family:Arial,sans-serif}li[_ngcontent-%COMP%]{background-color:#f9f9f9;border:1px solid #ddd;border-radius:8px;padding:16px;margin-bottom:12px;box-shadow:0 2px 4px #0000001a;transition:transform .2s ease,box-shadow .2s ease}li[_ngcontent-%COMP%]:hover{transform:translateY(-3px);box-shadow:0 4px 8px #00000026}li[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#333}li[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{margin-top:12px}li[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#555;margin:4px 0}"]})}}return e})();var H=(()=>{class e{static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275cmp=d({type:e,selectors:[["app-notification-page"]],decls:4,vars:0,template:function(i,a){i&1&&(r(0,"article")(1,"h2"),o(2,"My notifications"),n(),p(3,"app-notification-list"),n())},dependencies:[N]})}}return e})();var Q=[{path:"",component:H,canActivate:[O]}],dt=(()=>{class e{static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275mod=R({type:e})}static{this.\u0275inj=M({imports:[w,L.forChild(Q),N]})}}return e})();export{dt as NotificationModule};
